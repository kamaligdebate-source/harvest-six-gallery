<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Great Field | Harvest Six</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-green: #5d6d4f;
            --gold: #b89d5d;
            --sky-top: #a5d6f7;
            --sky-bottom: #e1f5fe;
        }

        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; font-family: 'Poppins', sans-serif;
        }

        /* BETTER BACKGROUND: Watercolor Gradient & Clouds */
        .big-garden-container {
            width: 100vw; height: 100vh;
            background: linear-gradient(to bottom, var(--sky-top) 0%, var(--sky-bottom) 40%, #ffffff 100%);
            position: relative;
        }

        /* CLOUD ANIMATIONS */
        .cloud {
            position: absolute; color: white; opacity: 0.6; filter: blur(3px);
            animation: floatCloud linear infinite;
        }
        @keyframes floatCloud {
            from { left: -200px; }
            to { left: 110vw; }
        }

        .sun { 
            position: absolute; top: 40px; right: 10%; font-size: 80px; 
            filter: blur(1px) drop-shadow(0 0 50px #fff9c4); z-index: 1; 
        }

        /* THE FIELD */
        #bigField { position: absolute; bottom: 0; width: 100%; height: 55vh; z-index: 20; pointer-events: none; }

        .grain-stalk {
            position: absolute; bottom: -10px; transform-origin: bottom;
            animation: sway 6s ease-in-out infinite alternate;
        }
        @keyframes sway { 
            0% { transform: rotate(-3deg); } 
            100% { transform: rotate(3deg); } 
        }

        /* DEER: THE LEAP */
        .deer {
            position: absolute; font-size: 40px; z-index: 15;
            animation: moveForward 18s linear infinite, deerJump 0.8s ease-in-out infinite alternate;
        }
        @keyframes moveForward {
            from { left: -100px; }
            to { left: 110vw; }
        }
        @keyframes deerJump {
            from { bottom: 80px; transform: rotate(5deg); }
            to { bottom: 120px; transform: rotate(-10deg); }
        }

        /* EAGLE: THE SOAR */
        .eagle-container {
            position: absolute; top: 120px; display: flex; flex-direction: column; 
            align-items: center; z-index: 5; animation: soar 22s linear infinite;
        }
        .eagle { font-size: 40px; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1)); }
        .scholar-banner {
            font-size: 9px; font-weight: 700; color: var(--gold);
            text-transform: uppercase; letter-spacing: 2px;
            background: rgba(255,255,255,0.9); padding: 4px 12px; 
            border-radius: 20px; margin-top: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        @keyframes soar {
            from { left: -200px; transform: translateY(0px); }
            50% { transform: translateY(-40px); }
            to { left: 110vw; transform: translateY(10px); }
        }

        /* UI ELEMENTS */
        .back-home {
            position: absolute; top: 30px; left: 30px; z-index: 1000;
            color: var(--primary-green); text-decoration: none; font-size: 11px;
            font-weight: 700; text-transform: uppercase; letter-spacing: 2px;
            padding: 10px 20px; border: 1.5px solid var(--primary-green); border-radius: 50px;
            background: white; transition: 0.3s;
        }
        .back-home:hover { background: var(--primary-green); color: white; }

        .total-counter {
            position: absolute; top: 30px; right: 30px; text-align: right;
            font-family: 'Playfair Display', serif; color: var(--primary-green);
        }
    </style>
</head>
<body>

<div class="big-garden-container">
    <div class="sun">‚òÄÔ∏è</div>
    
    <div id="cloudLayer"></div>
    <div id="airLayer"></div>
    <div id="bigField"></div>

    <a href="index.html" class="back-home">‚Üê Return to Gallery</a>
    
    <div class="total-counter">
        <div style="font-size: 2.5rem; line-height: 1;" id="countText">0</div>
        <div style="font-size: 9px; text-transform: uppercase; letter-spacing: 2px; opacity: 0.7;">Total Field Grains</div>
    </div>
</div>

<script>
    const field = document.getElementById('bigField');
    const air = document.getElementById('airLayer');
    const cloudLayer = document.getElementById('cloudLayer');
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTHPJe3Zt0F1OO2gt1igtfKLmt4QdMedmq7qI3wn769I-lpWA0aMZ9I07v1DwJgdCuDz2i3t2wPyfmt/pub?output=csv';

    async function initRegistry() {
        // 1. Create Clouds
        for(let i=0; i<6; i++) {
            const cloud = document.createElement('div');
            cloud.className = 'cloud';
            cloud.innerHTML = '‚òÅÔ∏è';
            cloud.style.top = (Math.random() * 200) + "px";
            cloud.style.fontSize = (40 + Math.random() * 60) + "px";
            cloud.style.animationDuration = (25 + Math.random() * 20) + "s";
            cloud.style.animationDelay = (Math.random() * -30) + "s";
            cloudLayer.appendChild(cloud);
        }

        try {
            const res = await fetch(sheetUrl);
            const csv = await res.text();
            const lines = csv.split('\n').slice(1);
            
            let totalBreaks = 0;
            let nationalScholars = [];

            const scholars = lines.map(line => {
                const c = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                const bCount = parseInt(c[6]) || 0;
                totalBreaks += bCount;
                
                const name = c[0].replace(/^"|"$/g, '');
                const accolade = c[2] || "";
                if(accolade.length > 3) nationalScholars.push(name);

                return bCount;
            });

            document.getElementById('countText').innerText = totalBreaks;

            // 2. PLANT EXACT NUMBER OF GRAINS
            for(let i = 0; i < totalBreaks; i++) {
                const stalk = document.createElement('div');
                stalk.className = 'grain-stalk';
                stalk.innerHTML = 'üåæ';
                const depth = Math.random();
                stalk.style.left = Math.random() * 100 + "%";
                stalk.style.bottom = (depth * 150) - 10 + "px";
                stalk.style.fontSize = (25 + (depth * 60)) + "px";
                stalk.style.zIndex = Math.floor(depth * 100);
                stalk.style.opacity = 0.5 + (depth * 0.5);
                stalk.style.animationDelay = (Math.random() * 5) + "s";
                field.appendChild(stalk);
            }

            // 3. Spawn Deer (Small Family)
            spawnDeer();

            // 4. Spawn National Eagles
            if(nationalScholars.length > 0) {
                spawnEagle(nationalScholars);
                setInterval(() => spawnEagle(nationalScholars), 15000);
            }

        } catch (e) { console.error(e); }
    }

    function spawnDeer() {
        for(let i=0; i<3; i++) {
            const deer = document.createElement('div');
            deer.className = 'deer';
            deer.innerHTML = 'ü¶å';
            deer.style.animationDelay = (i * 1.2) + "s";
            field.appendChild(deer);
        }
    }

    function spawnEagle(names) {
        const name = names[Math.floor(Math.random() * names.length)];
        const container = document.createElement('div');
        container.className = 'eagle-container';
        container.innerHTML = `<div class="eagle">ü¶Ö</div><div class="scholar-banner">${name}</div>`;
        container.style.top = (80 + Math.random() * 120) + "px";
        air.appendChild(container);
        setTimeout(() => container.remove(), 25000);
    }

    initRegistry();
</script>

</body>
</html>
